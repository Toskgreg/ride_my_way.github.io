<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>Offer Ride</title>
    <link rel="stylesheet" type="text/css" href="css/mystyle8.css">
</head>
<body onload="update()">
    <h1></h1>
    <div id="content">
        <div id="background"></div>
        <form autocomplete="on" method="POST">
            <p class="formElement">Offer Ride</p>
            <input type="text" id="home" placeholder="Enter your pickup loaction" required>
            <input type="text" id="destination" placeholder="Enter your end destination " required>
            <p class="formElement">Depart Time</p>
            <input type="text" id="dateTime" placeholder="Format: Jan 1, 09:00 A.M" required>
        </form>
        <button id="back" onclick="back()"><span>Back</span></button>
        <button id="find" onclick="submit()" >Submit</button>
    </div>
</body>
<script>
    function update() {
        var userType = sessionStorage.getItem("userType");
        if (userType == "passenger") {
            document.getElementById("find").innerHTML = "<span>Find Drivers</span>";
        }
        else {
            document.getElementById("find").innerHTML = "<span>Find Passengers</span>";
        }
    }
    function TripForPassenger(date, pickUp, dropOff, driver) {
        this.date = date;
        this.pickUp = pickUp;
        this.dropOff = dropOff;
        this.driver = driver;
    }
    function TripForDriver(date, pickUp, dropOff, passengers) {
        this.date = date;
        this.pickUp = pickUp;
        this.dropOff = dropOff;
        this.passengers = passengers;
    }
    function submit() {
        var pickUp = document.getElementById("home").value;
        var dropOff = document.getElementById("destination").value;
        var date = document.getElementById("dateTime").value;

        if ( !(pickUp && dropOff && date) ) {
            alert("Please enter all the required fields");
            return;
        }

        var username = sessionStorage.getItem("user");
        var retrievedObj = localStorage.getItem(username);
        var userObj = JSON.parse(retrievedObj); 
        
        var userType = sessionStorage.getItem("userType");
        if (userType == "passenger") {
            userObj.passenger.currentTrip = new TripForPassenger(pickUp, dropOff, date, null);
            localStorage.setItem(username, JSON.stringify(userObj));
        }
        else {
            userObj.driver.currentTrip = new TripForDriver(pickUp, dropOff, date, null);
            localStorage.setItem(username, JSON.stringify(userObj));
        }

        sessionStorage.setItem("pickUp", pickUp);
        sessionStorage.setItem("dropOff", dropOff);
        sessionStorage.setItem("date", date);

        window.location.href = "SeeAvailable.html";
    }
    function back() {
        window.location.href = "MyAccount.html"
    }
</script>
</html>